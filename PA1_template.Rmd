---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

## Libraries used
```{r echo=TRUE,message=FALSE}
library(dplyr)
```

## Loading and preprocessing the data

```{r echo=TRUE}
data <- read.csv(unz("activity.zip","activity.csv"), na.strings="NA",
                 colClasses=c("integer","Date","integer"))

activity <- data %>% filter(!is.na(steps))
```

## What is mean total number of steps taken per day?

```{r echo=TRUE}
daily <- activity %>% group_by(date) %>% summarise(steps=sum(steps))
dmean   <- mean(daily$steps)
dmedian <- median(daily$steps)
hist(daily$steps, col="light blue", main="Daily Steps", xlab="steps")
abline(v=dmean,lty='dashed')
abline(v=dmedian,lty='dotted')
```

The mean total number of steps is: `r sprintf("%.4f",dmean)` and the median is `r dmedian`.

## What is the average daily activity pattern?

```{r echo=TRUE}
iactv <- activity %>% group_by(interval) %>% summarise(steps=mean(steps))
most_active_interval = iactv %>% filter(steps==max(steps))
with(iactv, plot(x=interval, y=steps, type="l"))
abline(v=most_active_interval[1,1],lti='dashed')
title(main="Daily activity pattern",sub="with most active interval")
```

The most active interval is: `r most_active_interval[1,1]` with a mean of `r  most_active_interval[1,2]` steps.

## Imputing missing values

There are a total of `r dim(data)[1]-dim(activity)[1]` missing values in the database.

To avoid bias in the calculations we're going to fill in the missing values using the mean of the missing data interval.

### Fill in NA values using interval mean

```{r echo=TRUE}
fill_in1 <- filter(data,is.na(steps)) %>% inner_join(iactv,by="interval") %>%
  select(steps=steps.y, date, interval) %>% rbind(activity)
```

```{r echo=TRUE}
daily1 <- fill_in1 %>% group_by(date) %>% summarise(steps=sum(steps))
dmean1   <- mean(daily1$steps)
dmedian1 <- median(daily1$steps)
hist(daily1$steps, col="light blue", main="Daily Steps", xlab="steps")
abline(v=dmean1,lty='dashed')
abline(v=dmedian1,lty='dotted')
```

The mean total number of steps is: `r sprintf("%.4f",dmean1)` and the median is `r sprintf("%.4f",dmedian1)`.

### Fill in NA values using daily mean

```{r echo=TRUE}
daily_mean <- activity %>% group_by(date) %>% summarise(steps=mean(steps))
fill_in2 <- filter(data,is.na(steps)) %>% inner_join(daily_mean,by="date") %>%
  select(steps=steps.y, date, interval) %>% rbind(activity)
```

```{r echo=TRUE}
daily2 <- fill_in2 %>% group_by(date) %>% summarise(steps=sum(steps))
dmean2   <- mean(daily2$steps)
dmedian2 <- median(daily2$steps)
hist(daily2$steps, col="light blue", main="Daily Steps", xlab="steps")
abline(v=dmean2,lty='dashed')
abline(v=dmedian2,lty='dotted')
```

The mean total number of steps is: `r sprintf("%.4f",dmean2)` and the median is `r sprintf("%.4f",dmedian2)`.

## Are there differences in activity patterns between weekdays and weekends?
